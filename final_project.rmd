---
title: "Final Project"
author: "S&DS 230/S&DS 530/ENV 757/PLSC 530"
subtitle: Due by 11:59am, Saturday, May 7, 2022
output:
  html_document: default
  word_document: default
  pdf_document: default
---

### Introduction: Background and Motivation

Understanding whether or not a country’s capital openness affects foreign direct investment can help policymakers better understand how to attract (or reduce) foreign investment.

### Goal of Analysis

Our questions of interest:
1. Among the variables selected for analysis, which ones have the greatest influence on gdp per capita?
2. 

```{r}
library(dplyr)
```

### Data

Our data includes yearly data across a variety of variables for 175 countries from 1970-2019. 

```{r}
fdi <- read.csv("fdi_data.csv")
dim(fdi)
head(fdi)
```

**1)  Data Cleaning**

*Variable Names and their Descriptions*

Categorical variables:

* conflict | Shows whether the country is in an armed conflict with any other country 

  * Value of 1 indicates conflict
  
  * Value of 0 indicates no conflict

* conflict_intensity | Shows the intensity of armed conflict in the country

  * Value of 0 indicates no conflict
  
  * Value of 1 indicates minor conflict
  
  * Value of 2 indicates major conflict
  
* conflict_type | Shows the type of conflict

  * Value of 0 indicates no conflict
  
  * Value of 1 indicates extrasystemic conflict
  
  * Value of 2 indicates interstate conflict
  
  * Value of 3 indicates intrastate conflict
  
  * Value of 4 indicates internationalized intrastate
  
Continuous:

* gdppc: Gross domestic product per capita (in USD)

* trade_dependence: Total trade (imports + exports) as percentage of GDP

* v2x_polyarchy

  * Value from 0 - 1
  
  * Electoral democracy index where higher values == stronger democratic institutions

* v2x_rule

  * Value from 0 - 1
  
  * Rule of law index -- measures extent to which laws are fairly enforced -- higher values == stronger rule of law

* v2x_gender: 

  * Value from 0 - 1 
  
  * Women's political empowerment index -- higher values == greater political empowerment for women

* ka_open: 

  * Value from 0 - 1
  
  * Measure of capital account openness -- higher values == greater integration with global financial markets


#### Data cleaning process

To start, looking at the variables conflict", "conflict_intensity", and "conflict_type", these variables are categorical but are represented as numbers. We will convert these values to booleans/more descriptive values to make it easier to work with and understand the data.

```{r}
fdi$conflict <- as.logical(fdi$conflict)
fdi$conflict_intensity[fdi$conflict_intensity == 0] <- "None"
fdi$conflict_intensity[fdi$conflict_intensity == 1] <- "Minor"
fdi$conflict_intensity[fdi$conflict_intensity == 2] <- "Major"
fdi$conflict_type[fdi$conflict_type == 0] <- "No conflict"
fdi$conflict_type[fdi$conflict_type == 1] <- "Extrasystemic"
fdi$conflict_type[fdi$conflict_type == 2] <- "Interstate"
fdi$conflict_type[fdi$conflict_type == 3] <- "Intrastate"
fdi$conflict_type[fdi$conflict_type == 4] <- "Internationalized intrastate"  
```

To further narrow down our data for this project, we will only be looking at data from countries in 2019. 
```{r}
fdi_2019 <- fdi[fdi$year == 2019,]
dim(fdi_2019)
head(fdi_2019)
```

**2)  Scraping More Info on S&P 500 Companies** - show appropriate use of at least ONE of each of the following – boxplot, 
scatterplot (can be matrix plot), normal quantile plot (can be related to regression), 
residual plots, histogram.

```{r}
# create scatterplot of gdp per capita vs. democracy index in 2019
plot(fdi_2019$gdppc, fdi_2019$v2x_polyarchy, xlab="GDP per capita", ylab="Democracy Index")
title("GDP per capita vs. Democracy Index in 2019")

# create scatterplot of gdp per capita vs. rule of law index in 2019
plot(fdi_2019$gdppc, fdi_2019$v2x_rule, xlab="GDP per capita", ylab="Rule of Law Index")
title("GDP per capita vs. Rule of Law Index in 2019")

# create scatterplot of gdp per capita vs. women's policital empowerment in 2019
plot(fdi_2019$gdppc, fdi_2019$v2x_gender, xlab="GDP per capita", ylab="Women's Political Empowerment Index")
title("GDP per capita vs. Women's Political Empowerment Index in 2019")

# create scatterplot of gdp per capita vs. measure of capital account openness
plot(fdi_2019$gdppc, fdi_2019$ka_open, xlab="GDP per capita", ylab="Capital Account Openness")
title("GDP per capita vs. Capital Account Openness in 2019")
```
This scatterplot does not convey a lot of useful information due to the outliers on the right side of the plot. To counteract this, we can replot this with the log of the GDP per capita.

```{r}
fdi_2019$log_gdppc <- log(fdi_2019$gdppc)
# create scatterplot of gdp per capita vs. democracy index in 2019
plot(fdi_2019$log_gdppc, fdi_2019$v2x_polyarchy, xlab="GDP per capita", ylab="Democracy Index")
title("Log of GDP per capita vs. Democracy Index in 2019")

# create scatterplot of gdp per capita vs. rule of law index in 2019
plot(fdi_2019$log_gdppc, fdi_2019$v2x_rule, xlab="GDP per capita", ylab="Rule of Law Index")
title("Log of GDP per capita vs. Rule of Law Index in 2019")

# create scatterplot of gdp per capita vs. women's policital empowerment in 2019
plot(fdi_2019$log_gdppc, fdi_2019$v2x_gender, xlab="GDP per capita", ylab="Women's Political Empowerment Index")
title("Log of GDP per capita vs. Women's Political Empowerment Index in 2019")

# create scatterplot of gdp per capita vs. measure of capital account openness
plot(fdi_2019$log_gdppc, fdi_2019$ka_open, xlab="GDP per capita", ylab="Capital Account Openness")
title("Log of GDP per capita vs. Capital Account Openness in 2019")

```

After logging the gdppc, it is a bit easier to see that there is a slight positive correlation with gdppc for the democracy index and the rule of law index. Plotting the GDP per capita with the women's empowerment index does not show a significant correlation in any way.


**3)  Basic Tests** - t-test, correlation, AND ability to create bootstrap confidence interval for 
either a t-test or a correlation.

Using a t-test, we analyzed if there was a difference in means between alliance_US and alliance_RU. We found that there was a significant difference in means between the two variables.


```{r}
# Create a dataframe with just two columns for target variables
gddpc_ttest_data <- data.frame(fdi$alliance_US, fdi$gdppc)

# Remove rows with missing values in any column of data frame
gddpc_ttest_data<- gddpc_ttest_data[complete.cases(gddpc_ttest_data),]

colnames(gddpc_ttest_data) <- c("Alliance with US", "GDP Per Capita")
(ttest <- t.test(gddpc_ttest_data$"GDP Per Capita" ~ gddpc_ttest_data$"Alliance with US", conf.level = .99))
```

**4)  Permutation Test** - include at least one.

**5)  Multiple Regression** - use either backwards stepwise regression or some form of best 
subsets regression.  Should include residual plots.  A GLM with a mix of continuous and 
categorical predictors is fine here.

**6)  AT LEAST ONE OF THE FOLLOWING TECHNIQUES** - ANOVA, ANCOVA, Logistic 
Regression, Multinomial Regression, OR data scraping off a website.

```{r}
fdi_anova <- fdi_2019[c("gdppc", "conflict_intensity", "conflict_type")]
fdi_anova <- fdi_anova[complete.cases(fdi_anova),]

```

####  Conclusion and Summary